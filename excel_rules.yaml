# Excel字段提取规则配置文件
# 可以配置多组规则，每组规则定义不同送货单的字段提取方式
# 送货单的name为excel_rules.yaml中的name(否则无法匹配excel_rules.yaml中的规则)

rules:
  池州华宇送货单:
    sheet_name: "Page 1"  # 固定的sheet名称
    sheet_format: "fixed"  # 固定的sheet名称
    header_marker:
      column: "A"    # 表头标记所在列
      value: "货号"   # 表头标记值
    footer_marker:
      column: "A"    # 表尾标记所在列
      value: "物流公司"  # 表尾标记值
    date_cell:       # 日期单元格位置
      row: 3         # 日期所在行（0-based）
      column: "P"    # 日期所在列
    skip_empty: true # 跳过空行
    fields:
      - name: "送货日期"  # 从date_cell提取
        column: ""
      - name: "订单号"
        column: "D"
      - name: "品名"
        column: "F"
      - name: "封装形式"
        column: "K"
      - name: "打印批号"
        column: "J"
      - name: "数量"
        column: "Q"
      - name: "晶圆名称"
        column: "O"
      - name: "晶圆批号"
        column: "L"
      - name: "供应商"
        value: "池州华宇"  # 固定值

  汉旗送货单:
    check_date: true  # 启用日期检查
    sheet_format: "number"  # 数字格式的sheet名称
    sheet_pattern: "^\\d+-\\d+(-\\d+)?$"  # sheet名称的正则表达式模式
    header_marker:
      column: "A"     # 表头标记所在列
      value: "序号"    # 表头标记值
    footer_marker:
      column: "H"     # 表尾标记所在列
      value: "Total"  # 表尾标记值
    date_cell:        # 日期单元格位置
      row: 2          # 日期所在行（0-based）
      column: "G"     # 日期所在列
      pattern: "日期:\\s*(\\d{4}-\\d{2}-\\d{2})"  # 日期提取正则表达式
    default_start_row: 6  # 默认起始行（从序号开始的行）
    skip_empty: true  # 跳过空行
    fields:
      - name: "送货日期"  # 从date_cell提取
        column: ""
      - name: "订单号"
        column: "E"
      - name: "品名"
        column: "C"
      - name: "封装形式"
        column: "H"
      - name: "打印批号"
        column: "F"
      - name: "数量"
        column: "I"
      - name: "晶圆名称"
        column: "B"
      - name: "晶圆批号"
        column: "D"
      - name: "供应商"
        value: "山东汉旗"  # 固定值

  芯丰送货单:
    sheet_format: "date"  # 使用日期格式
    sheet_pattern: "^XSCKD(\\d{8})\\d+$"  # sheet名称的正则表达式模式，用于提取日期
    header_marker:
      column: "A"    # 表头标记所在列
      value: "序号"   # 表头标记值
    footer_marker:
      column: "A"    # 表尾标记所在列
      value: ""      # 空值作为表尾标记
    date_cell:       # 日期单元格位置
      row: 2         # 日期所在行（0-based，对应Excel中的第3行）
      column: "L"    # 日期所在列
      pattern: "出货日期:\\s*(\\d{4}/\\d{2}/\\d{2})"  # 日期提取正则表达式
    default_start_row: 9  # 默认起始行（从序号开始的行）
    skip_empty: true # 跳过空行
    fields:
      - name: "送货日期"  # 从date_cell提取
        column: ""
      - name: "订单号"
        column: "C"
      - name: "品名"
        column: "D"
      - name: "封装形式"
        column: "E"
      - name: "打印批号"
        column: ""
      - name: "数量"
        column: "H"
      - name: "晶圆名称"
        column: "F"
      - name: "晶圆批号"
        column: "G"
      - name: "供应商"
        value: "江苏芯丰"  # 固定值
